dom.define("lang",Array.isArray&&Object.create?"":"ecma",function(){function k(a){switch(dom.type(a)){case "Array":return h.clone.call(a);case "Object":return o.clone.call(a);default:return a}}function p(a,b,c){if(a[b]&&typeof a[b]=="object")o.merge.call(a[b],c);else a[b]=k(c);return a}function q(a){s[a].concat(Object.keys(dom[a])).forEach(function(b){r[b]=function(){var c=this.target;return(c[b]?c[b]:dom[this.type][b]).apply(c,arguments)};r[b+"X"]=function(){var c=this.target;c=(c[b]?c[b]:dom[this.type][b]).apply(c,
arguments);return i.call(this,c)}});return q}var g=this,t=/[^\x00-\xff]/g,u=/\\?\#{([^{}]+)\}/gm,v=/^(area|base|basefont|bgsound|br|col|frame|hr|img|input|isindex|link|meta|param|embed|wbr)$/i,w=/^[\],:{}\s]*$/,x=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,y=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,z=/(?:^|:|,)(?:\s*\[)+/g,A=g.execScript?"execScript":"eval",B=(g.open+"").replace(/open/g,"");dom.mix(dom,{isPlainObject:function(a){if(!dom.type(a,"Object")||dom.isNative(a,"reload"))return false;
try{for(var b in a)if(!l.hasOwnProperty.call(a,b))return false}catch(c){return false}return true},isNative:function(a,b){var c=a?a[b]:false,d=RegExp(b,"g");return!!(c&&typeof c!="string"&&B===(c+"").replace(d,""))},isEmptyObject:function(a){for(var b in a)return false;return true},isArrayLike:function(a){if(!a||a.document||a.nodeType||dom.type(a,"Function"))return false;return isFinite(a.length)},format:function(a,b){var c=dom.slice(arguments,1);return a.replace(u,function(d,e){if(d.charAt(0)=="\\")return d.slice(1);
var f=Number(e);if(f>=0)return c[f];if(b&&b[e]!==void 0)return b[e];return""})},tag:function(a,b,c){c=!!c;var d=function(e,f,j){var m=arguments.callee.html;e&&m.push("<",e,">");(f=""+(f||""))&&m.push(f);var n=e.split(" ")[0];if(n&&(j||!v.test(n)))m.push("</",n,">");return d};d.html=[];d.toString=function(){return this.html.join("")};return d(a,b,c)},range:function(a,b,c){if(arguments.length<=1){b=a||0;a=0}c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);e<d;){f[e++]=a;a+=
c}return f},quote:g.JSON&&JSON.stringify||String.quote||function(){var a={"\t":"t","\n":"n","\u000b":"v",f:"f","\r":"\r","'":"'",'"':'"',"\\":"\\"},b=/[\x00-\x1F\'\"\\\u007F-\uFFFF]/g,c=function(d){if(d in a)return"\\"+a[d];var e=d.charCodeAt(0);return e<32?"\\x0"+e.toString(16):e<127?"\\"+d:e<256?"\\x"+e.toString(16):e<4096?"\\u0"+e.toString(16):"\\u"+e.toString(16)};return function(d){return'"'+d.replace(b,c)+'"'}}(),parseJS:function(a){if(a&&/\S/.test(a))try{g[A](a)}catch(b){}},parseJSON:function(a){if(typeof a!==
"string"||!a)return null;a=a.trim();if(g.JSON&&g.JSON.parse)return g.JSON.parse(a);if(w.test(a.replace(x,"@").replace(y,"]").replace(z,"")))return(new Function("return "+a))();dom.error("Invalid JSON: "+a)},parseXML:function(a,b,c){try{if(g.DOMParser){c=new DOMParser;b=c.parseFromString(a,"text/xml")}else{b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a)}}catch(d){b=undefined}if(!b||!b.documentElement||b.getElementsByTagName("parsererror").length)dom.log("Invalid XML: "+a);return b}},
false);"Array,Function".replace(dom.rword,function(a){dom["is"+a]=function(b){return b&&{}.toString.call(b)==="[object "+a+"]"}});if(Array.isArray)dom.isArray=Array.isArray;var l=dom.String={contains:function(a,b){return b?!!~(b+this+b).indexOf(b+a+b):!!~this.indexOf(a)},startsWith:function(a,b){var c=this.substr(0,a.length);return b?c.toLowerCase()===a.toLowerCase():c===a},endsWith:function(a,b){var c=this.substring(this.length-a.length);return b?c.toLowerCase()===a.toLowerCase():c===a},byteLen:function(){return this.replace(t,
"--").length},empty:function(){return this.valueOf()===""},blank:function(){return/^\s*$/.test(this)},truncate:function(a,b){a=a||30;b=b===void 0?"...":b;return this.length>a?this.slice(0,a-b.length)+b:String(this)},camelize:function(){return this.replace(/-([a-z])/g,function(a,b){return b.toUpperCase()})},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},underscored:function(){return this.replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/\-/g,"_").toLowerCase()},
toInt:function(a){return parseInt(this,a||10)},toFloat:function(){return parseFloat(this)},toHex:function(){for(var a="",b=0;b<this.length;b++)a+=this.charCodeAt(b).toString(16).toUpperCase().length<2?"\\x0"+this.charCodeAt(b).toString(16).toUpperCase():"\\x"+this.charCodeAt(b).toString(16).toUpperCase();return a},escapeRegExp:function(){return this.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},padLeft:function(a,b,c){c=this.toString(c||10);for(b=b||"0";c.length<a;)c=b+c;return c},padRight:function(a,
b,c){c=this.toString(c||10);for(b=b||"0";c.length<a;)c+=b;return c},times:function(a){for(var b=this,c="";a>0;){if(a&1)c+=b;b+=b;a>>=1}return c}},h=dom.Array={clone:function(){for(var a=this.length,b=[];a--;)b[a]=k(this[a]);return b},first:function(a,b){if(dom.type(a,"Function")){for(var c=0,d=this.length;c<d;c++)if(a.call(b,this[c],c,this))return this[c];return null}else return this[0]},last:function(a,b){if(dom.type(a,"Function")){for(var c=this.length-1;c>-1;c--)if(a.call(b,this[c],c,this))return this[c];
return null}else return this[this.length-1]},contains:function(a){return!!~this.indexOf(a)},remove:function(a){a=this.indexOf(a);if(~a)return h.removeAt.call(this,a);return null},removeAt:function(a){return this.splice(a,1)},shuffle:function(){for(var a=(this||[]).concat(),b,c,d=a.length;d>0;b=parseInt(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a},random:function(){return h.shuffle.call(this)[0]},min:function(){return Math.min.apply(0,this)},max:function(){return Math.max.apply(0,this)},ensure:function(){dom.slice(arguments).forEach(function(a){~this.indexOf(a)||
this.push(a)},this);return this},pluck:function(a){var b=[],c;this.forEach(function(d){c=d[a];c!=null&&b.push(c)});return b},sortBy:function(a,b){var c=this.map(function(d,e){return{el:d,re:a.call(b,d,e)}}).sort(function(d,e){var f=d.re,j=e.re;return f<j?-1:f>j?1:0});return h.pluck.call(c,"el")},compact:function(){return this.filter(function(a){return a!=null})},diff:function(a){for(var b=this.slice(),c=0;c<b.length;c++)for(var d=0;d<a.length;d++)if(b[c]===a[d]){b.splice(c,1);c--;break}return b},
union:function(a){var b=this;b=b.concat(a);return dom.Array.unique.call(b)},intersect:function(a){return this.filter(function(b){if(~a.indexOf(b))return true;return false})},unique:function(){var a=[],b=0,c=this.length;a:for(;b<c;b++){for(var d=b+1;d<c;d++)if(this[d]===this[b])continue a;a.push(this[b])}return a},flatten:function(){var a=[],b=h.flatten;this.forEach(function(c){if(dom.isArray(c))a=a.concat(b.call(c));else a.push(c)});return a}};h.without=h.diff;var C="abs,acos,asin,atan,atan2,ceil,cos,exp,floor,log,pow,sin,sqrt,tan".match(dom.rword),
D=dom.Number={times:function(a,b){for(var c=0;c<this;c++)a.call(b,c);return this},padLeft:function(a,b,c){return l.padLeft.apply(this,[a,b,c])},padRight:function(a,b,c){return l.padRight.apply(this,[a,b,c])},constrain:function(a,b){var c=[a,b].sort(),d=Number(this);if(d<c[0])d=c[0];if(d>c[1])d=c[1];return d},nearer:function(a,b){var c=Number(this);return Math.abs(c-a)<Math.abs(c-b)?a:b},upto:function(a,b,c){for(var d=this+0;d<=a;d++)b.call(c,d);return this},downto:function(a,b,c){for(var d=this+0;d>=
a;d--)b.call(c,d);return this},round:function(a){if(a){a=Math.pow(10,a);return Math.round(this*a)/a}else return Math.round(this)}};C.forEach(function(a){D[a]=function(){return Math[a](this)}});var o=dom.Object={subset:function(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c];b[e]=this[e]}return b},forEach:function(a,b){for(var c in this)a.call(b,this[c],c,this);if(dom.DONT_ENUM&&this.hasOwnProperty)for(var d=0;c=dom.DONT_ENUM[d++];)this.hasOwnProperty(c)&&a.call(b,this[c],c,this)},clone:function(){var a=
{},b;for(b in this)a[b]=k(this[b]);return a},merge:function(a,b){var c,d;if(typeof a==="string")return p(this,a,b);for(var e=0,f=arguments.length;e<f;e++){c=arguments[e];for(d in c)c[d]!==void 0&&p(this,d,c[d])}return this},without:function(a){var b={},c;for(c in this)~a.indexOf(c)||(b[c]=this[c]);return b}},s={String:["charAt","charCodeAt","concat","indexOf","lastIndexOf","localeCompare","match","replace","search","slice","split","substring","toLowerCase","toLocaleLowerCase","toUpperCase","toLocaleUpperCase",
"trim","toJSON"],Array:["toLocaleString","concat","join","pop","push","shift","slice","sort","reverse","splice","unshift","indexOf","lastIndexOf","every","some","forEach","map","filter","reduce","reduceRight"],Number:["toLocaleString","toFixed","toExponential","toPrecision","toJSON"],Object:["toLocaleString","hasOwnerProperty","isPrototypeOf","propertyIsEnumerable"]},E=dom.oneObject("String,Array,Number,Object"),F=dom.oneObject("NodeList,Arguments,Object"),i=dom.lang=function(a){var b=dom.type(a),
c=this;if(F[b]&&isFinite(a.length)){a=dom.slice(a);b="Array"}if(E[b]){c instanceof i||(c=new i);c.target=a;c.type=b;return c}else return a},r=i.prototype={constructor:i,valueOf:function(){return this.target},toString:function(){return this.target+""}};q("Array")("String")("Number")("Object");return i});
