dom.define("dispatcher","data",function(){function x(a,b){return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||a.id===b[2])&&(!b[3]||b[3].test(a.className))&&(!b[4]||a.getAttribute(b[4])==b[5])}var q=this,t=q.document,s="",u=/\bhover(\.\S+)?/,v=/^([^\.]*)?(?:\.(.+))?$/,y=/(^|_|:)([a-z])/g,l=dom.event={special:{},bind:function(a,b,c,e){var f=this,d=dom._data(f),h=dom["@dispatcher"]in f;e=e||c;var g,o,m,j,k,n,p;if(!(f.nodeType===3||f.nodeType===8||!a||!b||!d)){c=c&&c.length?c:false;var z=b.uuid||
(b.uuid=dom.uuid++);g={handler:b,uuid:z,times:e>0?e:Infinity};g.handler.uuid=g.uuid;if(h){p=d.handle||(d.handle=function(i){return(i||event).type!==s?l.handle.apply(p.target,arguments):void 0});p.target=f;a=a.replace(u,"mouseover$1 mouseout$1")}d=d.events||(d.events={});a.replace(dom.rword,function(i){o=v.exec(i)||[];i=o[1];m=(o[2]||"").split(".").sort();j=h&&l.special[i]||{};i=(c?j.delegateType:j.bindType)||i;j=h&&l.special[i]||{};k=dom.mix({type:i,origType:o[1],selector:c,namespace:m.join(".")},
g);n=d[i]=d[i]||[];if(h&&!n.length)if(!j.setup||j.setup(f,c,p)===false)dom.bind(f,i,p,!!c);i=true;for(var A=k.handler,B=0,w;w=n[B++];)if(w.handler===A){i=false;break}i&&n.push(k)})}},unbind:function(a,b,c){var e=dom._data(this,"events");if(e){var f,d,h,g,o=dom["@dispatcher"]in this,m,j,k,n;a=o?(a||"").replace(u,"mouseover$1 mouseout$1"):a;a=(a||"").match(dom.rword)||[];for(f=0;f<a.length;f++){d=v.exec(a[f])||[];h=d[1];d=d[2];if(!h){d=d?"."+d:"";for(m in e)l.unbind.call(this,m+d,b,c);return}j=l.special[h]||
{};h=(c?j.delegateType:j.bindType)||h;k=e[h]||[];g=k.length;d=d?RegExp("(^|\\.)"+d.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;if(b||d||c)for(m=0;m<k.length;m++){n=k[m];if(!b||b.uuid===n.uuid)if(!d||d.test(n.namespace))if(!c||c===n.selector||c==="**"&&n.selector)k.splice(m--,1)}else k.length=0;if(o&&k.length===0&&g!==k.length){if(!j.teardown||j.teardown(this,c,b)===false)dom.unbind(this,h,dom._data(this,"handle"));delete e[h]}}if(dom.isEmptyObject(e)){dom.removeData(this,"handle").target=
null;dom.removeData(this,"events")}}},fire:function(a){var b=[],c=a.type||a;if(~c.indexOf(".")){b=c.split(".");c=b.shift();b.sort()}a=typeof a=="object"&&"namespace"in a?c:new r(c);a.target=this;a.namespace=b.join(".");a.namespace_re=a.namespace?RegExp("(^|\\.)"+b.join("\\.(?:.*\\.)?")+"(\\.|$)"):null;b=[a].concat(dom.slice(arguments,1));if(dom["@dispatcher"]in this){var e=this,f="on"+c;do{if(dom._data(e,"events")||{}[c])l.handle.apply(e,b);e[f]&&e[f].call(e)===false&&a.preventDefault();e=e.parentNode||
e.ownerDocument||e===this.ownerDocument&&q}while(e&&!a.isPropagationStopped);if(!a.isDefaultPrevented){var d;if(f&&this[c]&&(c!=="focus"&&c!=="blur"||this.offsetWidth!==0)&&!this.eval){if(d=this[f])this[f]=null;s=c;this[c]()}s="";if(d)this[f]=d}}else l.handle.apply(this,b)},filter:function(a,b,c){for(var e=typeof c==="function"?c:c.input?x:dom.match;a!=b;a=a.parentNode||b)if(e(a,c))return true;return false},handle:function(a){var b=l.fix(a||b),c=dom._data(this,"events");if(c){c=c[b.type]||[];b.currentTarget=
this;var e=b.target,f=[b].concat(dom.slice(arguments,1)),d;c=c.concat();for(var h=0,g;g=c[h++];)if(!e.disabled&&!(b.button&&b.type==="click")&&(!g.selector||l.filter(e,this,g.selector))&&(!b.namespace||b.namespace_re.test(g.namespace))){b.type=g.origType;d=g.handler.apply(this,f);g.times--;g.times===0&&l.unbind.call(this,b.type,g.handler,g.selector);if(d!==void 0){b.result=d;if(d===false){b.preventDefault();b.stopPropagation()}}if(b.isImmediatePropagationStopped)break}}return b.result},fix:function(a){if(!("namespace"in
a)){var b=a;a=new r(b);for(var c in b)if(typeof b[c]!=="function"&&c!=="type")/^[A-Z_]+$/.test(c)||(a[c]=b[c]);if("wheelDelta"in b){b=b.wheelDelta/120;if(q.opera&&q.opera.version()<10)b=-b;a.wheelDelta=Math.round(b)}else if("detail"in b)a.wheelDelta=-a.detail/3;if(!a.target){a.which=a.button===2?3:a.button===4?2:1;a.target=a.srcElement||t}if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==
null&&a.clientX!=null){c=a.target.ownerDocument||t;b=c.documentElement;c=c.body;a.pageX=a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b&&b.clientLeft||c&&c.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||c&&c.scrollTop||0)-(b&&b.clientTop||c&&c.clientTop||0)}if(!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey}return a}},r=dom.Event=function(a){this.originalEvent=a.substr?{}:a;this.type=a.type||a;this.timeStamp=
Date.now();this.namespace=""};r.prototype={constructor:r,toString:function(){return"[object Event]"},preventDefault:function(){this.isDefaultPrevented=true;var a=this.originalEvent;a.preventDefault&&a.preventDefault();a.returnValue=false;return this},stopPropagation:function(){this.isPropagationStopped=true;var a=this.originalEvent;a.stopPropagation&&a.stopPropagation();a.cancelBubble=true;return this},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=true;this.stopPropagation();
return this}};dom.dispatcher={};"bind,unbind,fire".replace(dom.rword,function(a){dom.dispatcher[a]=function(){l[a].apply(this,arguments);return this}});dom.dispatcher.uniqueNumber=dom.uuid++;dom.dispatcher.defineEvents=function(a){var b=[];if(typeof a=="string")b=a.match(dom.rword);else if(dom.isArray(a))b=a;b.forEach(function(c){var e="on"+c.replace(y,function(f,d,h){return h.toUpperCase()});e in this||(this[e]=function(){return this.bind.apply(this,[].concat.apply([c],arguments))})},this)}});
